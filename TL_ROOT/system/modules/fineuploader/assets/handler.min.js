var ContaoFineUploader={};!function(){"use strict";var e={};ContaoFineUploader.init=function(t,n,i){e[n.field]=document.getElementById("ctrl_"+n.field).value;var a={element:t,debug:!1,request:{endpoint:window.location.href,inputName:n.field+"_fineuploader",params:{action:"fineuploader_upload",name:n.field,REQUEST_TOKEN:n.request_token}},maxConnections:n.maxConnections,chunking:{enabled:!!n.chunking,partSize:n.chunkSize,concurrent:!!n.concurrent},failedUploadTextDisplay:{mode:"custom",maxChars:1e3,responseProperty:"error"},text:{fileInputTitle:n.uploadButtonTitle},validation:{allowedExtensions:n.extensions,minSizeLimit:n.minSizeLimit,sizeLimit:n.sizeLimit},callbacks:{onValidateBatch:function(t){var i=""===e[n.field]?0:e[n.field].split(",").length;return 1==n.limit&&1==t.length&&1==i&&(i=0,e[n.field]="",this.clearStoredFiles()),n.limit>0&&n.limit<i+t.length?(this._batchError(this._options.messages.tooManyItemsError.replace(/\{netItems\}/g,i+t.length).replace(/\{itemLimit\}/g,n.limit)),!1):void(n.onValidateBatchCallback&&n.onValidateBatchCallback.apply(this,arguments))},onUpload:function(){n.backend&&AjaxRequest.displayBox(Contao.lang.loading+" â€¦"),n.onUploadCallback&&n.onUploadCallback.apply(this,arguments)},onComplete:function(t,i,a){return a.success?(a.file&&(e[n.field]=(e[n.field].length?e[n.field]+",":"")+a.file),void(this.getInProgress()>0||(n.backend?new Request.Contao({field:document.getElementById("ctrl_"+n.field),evalScripts:!1,onSuccess:function(e,t){document.getElementById("ctrl_"+n.field).getParent("div").set("html",t.content),t.javascript&&Browser.exec(t.javascript),AjaxRequest.hideBox(),window.fireEvent("ajax_change")}}).post({action:"fineuploader_reload",name:n.field,value:e[n.field],REQUEST_TOKEN:n.request_token}):document.getElementById("ctrl_"+n.field).value=e[n.field],n.onCompleteCallback&&n.onCompleteCallback.apply(this,arguments)))):void(n.backend&&AjaxRequest.hideBox())}}};for(var l in i)a[l]=i[l];return new qq.FineUploader(a)},ContaoFineUploader.deleteItem=function(e,n){var i=e.parentNode,a=i.getAttribute("data-id");t(document.getElementById("ctrl_"+n),a),i.parentNode.removeChild(i)},ContaoFineUploader.makeSortable=function(e,t){var n,i=new Sortables(document.getElementById(e),{contstrain:!0,opacity:.6}).addEvent("complete",function(){var i=[],a=document.getElementById(e).getChildren("li");for(n=0;n<a.length;n++)i.push(a[n].get("data-id"));document.getElementById(t).value=i.join(",")});i.fireEvent("complete")};var t=function(t,n){var i,a=t.value.split(",");for(i=0;i<a.length;i++)if(a[i]==n){a.splice(i,1);break}e[t.id]=a.join(","),t.value=e[t.id]}}();